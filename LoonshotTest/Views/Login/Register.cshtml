

@{
    string msg = ViewData["msg"] as string;
    //string msg = "";
}

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script>



</script>
<link href="~/css/register.css" rel="stylesheet" />

<html>
<body>
    <div class="auth-wrapper d-flex no-block justify-content-center align-items-center position-relative">
        <div class="auth-box row" style="justify-content: center;" >
            <div class="col-sm-12 col-lg-12" style=" background-color: rgb(255,255,255,0.5); padding: 0px 30px 0px 30px; margin:100px 0px; border-radius:10px;">
                <div class="p-3">
                    <h2 class="mt-3 text-center">Sign Up for Free</h2>
                    <!--
    @if (string.IsNullOrWhiteSpace(msg) == false)
    {
        <div id ="notify" class="alert alert-danger">@msg</div>
    }
    -->
                    <div id="notify" class="alert alert-danger"></div>
                    <form id="form1" method="post" action="/login/register" class="mt-4">
                        <div class="row">
                            <div class="col-lg-12 col-sm-12">
                                <div class="form-group">
                                    <input id="login_id" name="patient_login_id" class="form-control" type="text" placeholder="insert your id">
                                    <!--<input name="patient_login_id" class="form-control" type="text" placeholder="insert your id" onkeyup="checkId(this.value);">-->
                                    <br />
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-6 col-lg-12">
                                <div class="form-group">
                                    <input id="login_pw" name="patient_login_pw" class="form-control" type="password" placeholder="insert your password">
                                    <!--<input name="patient_login_pw" class="form-control" type="password" placeholder="insert your password" onkeyup="checkPw(this.value);">-->
                                    <br />
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <input id="login_pw2" name="patient_login_pw2" class="form-control" type="password" placeholder="confirm password">
                                </div>
                                <br />
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-lg-12">
                                <input id="regiden_regist" name="resident_regist_num" class="form-control" type="text" placeholder="insert your regident registnumber"> 
                            </div>
                            
                        </div>
                        <br/>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group">
                                    <input id="pnNum" name="phone_num" class="form-control" type="text" placeholder="your phone number">
                                    <br />
                                    <input id="authNum" name="Authentication number" class="form-control" type="text" placeholder="Authentication number">
                                </div>
                            </div>
                        </div>

                        <br />
                        <div class="row">
                            <div class="col-lg-12 text-center">
                                <button type="button" class="btn btn-secondary" onClick="fncAuth()">Send Code</button>
                                <button id="certify" type="button" class="btn btn-success" onClick="fncCheckAuth()" disabled>Certify</button>
                                <button id="signUp" type="submit" class="btn btn-primary" disabled>Sign Up</button>
                            </div>
                        

                        <div class="row">
                            <div class="col-lg-12 text-center mt-5">
                                Already have an account? <br /><a href="/login/login" class="text-danger">Sign In</a>
                            </div>
                        </div>

                    </form>
                </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

<script>
    var arr = [];

    $("#login_id").change(function () {
        console.log($(this).val());
        if ($(this).val() != null) {
            $.ajax({
                url: "/login/idCheck",
                method: "POST",
                data: {
                    id: $(this).val()
                },
                success:
                    function (resp) {
                        console.log("³Ñ¾î¿Â ¸Þ¼¼Áö : " + resp);
                        $("#notify").text(resp);
                    }
            });	 //ajaxÁ¾·á
        }; //if¹® Á¾·á
        
    }); // ¾ÆÀÌµð Ã¼Å© Á¾·á


    $("#login_pw").change(function () {
        console.log($(this).val());
        $.ajax({
            url: "/login/pwCheck",
            method: "POST",
            data: {
                pw: $(this).val()
            },
            success:
                function (resp) {
                    console.log("³Ñ¾î¿Â ¸Þ¼¼Áö : " + resp);
                    $("#notify").text(resp);
                }
        });	 //ajaxÁ¾·á
    })//ºñ¹ø Ã¼Å© Á¾·á

    $("#login_pw2").change(function () {
        var status = "";
        console.log($(this).val());
        if ($(this).val() != $("#login_pw").val()) {
            status = "F";
        } else {
            status = "T";
        }
        $.ajax({
            url: "/login/pwCheck2",
            method: "POST",
            data: {
                status: status
            },
            success:
                function (resp) {
                    console.log("³Ñ¾î¿Â ¸Þ¼¼Áö : " + resp);
                    $("#notify").text(resp);
          }
        });	 //ajaxÁ¾·á
    })//ºñ¹ø1 ºñ¹ø2 µ¿ÀÏ¿©ºÎ Ã¼Å© Á¾·á

    $("#regiden_regist").change(function () {

        $.ajax({
            url: "/login/rsCheck",
            method: "POST",
            data: {
                rs: $(this).val()
            },
            success:
                function (resp) {
                    console.log("³Ñ¾î¿Â ¸Þ¼¼Áö : " + resp);
                    $("#notify").text(resp);
                }
        });	 //ajaxÁ¾·á


    })//ÁÖ¹Î¹øÈ£ À¯È¿¼º Ã¼Å© Á¾·á




    /*
    var key = "";
    var authNum = "";
    var chkPhone = /^[0-9]{11}$/
    // ÁÖ¹Î¹øÈ£ ¹øÈ£¸¸À¸·Î 13ÀÚ¸® ÀÔ·Â
    var chkRegist = /^[0-9]{13}$/
    // »ç¿ëÀÚ ÀÌ¸§ ÇÑ±Û¸¸ÀÔ·Â °¡´É 2~4ÀÚ¸®·Î ÀÔ·Â
    var chkName = /^[°¡-ÆR]{2,4}$/
    // ·ÎÄÃ ¾ÆÀÌµð ¿µ¾î¸¸ÀÔ·Â °¡´É 5~15ÀÚ¸®·Î ÀÔ·Â
    var chkId = /^[a-zA-z]{5,15}$/
    // ·ÎÄÃ ºñ¹Ð¹øÈ£ ¼ýÀÚ,¹®ÀÚ,Æ¯¼ö¹®ÀÚÀÔ·Â ÃÖ¼Ò 8ÀÚ¸®ÀÌ»óÀ¸·Î ÀÔ·Â
    var chkPw = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[$$!%*#?&])[A-Za-z\d$$!%*#?&]{8,}$/
    function checkPhone(v) {
        if (!chkPhone.test(v)) {
            console.log("error input");
        }
    }
    function checkRegist(v) {
        if (!chkRegist.test(v)) {
            console.log("error input");
        }
    }
    function checkName(v) {
        if (!chkName.test(v)) {
            console.log("error input");
        }
    }
    function checkId(v) {
        if (!chkId.test(v)) {
            console.log("error input");
        }
    }
    function checkPw(v) {
        if (!chkPw.test(v)) {
            console.log("error input");
        }
    }



    /*
    $("#authNum").keypress(function (e) {
        //console.log(e.key);
        authNum += e.key;
        console.log(authNum);
    });
   */

    function fncAuth() {

        var phone = $("#pnNum").val()

        if (phone == null || phone.length != 11) {

            alert("disable phone number");
            return;
        }
        alert("send authenticate number");

        $.ajax({
            url: "/login/sendSMS?phone=" + phone,
            method: "GET",
            success:
                function (resp) {
                    console.log("³Ñ¾î¿Â Å° °ª : " + resp);
                    $("#certify").removeAttr('disabled');
                    //alert(resp);
                    key = resp;
                    //alert(key);
                }

        });	 //ajaxÁ¾·á */
    };


    function fncCheckAuth() {

        authNum = $("#authNum").val();

        if (authNum == key) {
            alert("Success");
            $("#signUp").removeAttr('disabled');
        }

        if (authNum != key) {
            alert("Fail")
        }

    }
</script>