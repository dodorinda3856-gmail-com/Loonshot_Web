<script type="text/javascript"
        src="https://service.iamport.kr/js/iamport.payment-1.1.5.js"></script>

<script src="~/lib/jquery/dist/jquery.js"></script>



<h1 style="padding-top:200px">결제하실 금액은 <span class="amount" >150</span>원 입니다.</h1>

<button class="btn btn-outline-primary" type="button"
        id="check_module" onclick="javascript:pay(price)"
        name="cp_item">
    결제하기
</button>



<script>
		//let userId = $('#userId').val();
		//alert(userId);
	let price = $('.amount').text();
	alert(price);
		function pay(price) {
			var IMP = window.IMP; // 생략가능
            IMP.init('imp05145437');
			//var price = $(this).find('input').val()
			//var price = $('button[name="cp_item"]:checked').val();
			//var price = $(this).attr("price");
			console.log(price);

			IMP.request_pay({
				pg : 'inicis',
				//pg : 'kakao',
				/*
				'kakao':카카오페이,
				html5_inicis':이니시스(웹표준결제)
				'nice':나이스페이
				'jtnet':제이티넷
				'uplus':LG유플러스
				'danal':다날
				'payco':페이코
				'syrup':시럽페이
				'paypal':페이팔
				 */
				pay_method : 'card',
				/*
				'samsung':삼성페이,
				'card':신용카드,
				'trans':실시간계좌이체,
				'vbank':가상계좌,
				'phone':휴대폰소액결제
				 */
				merchant_uid : 'merchant_' + new Date().getTime(),

				name : '진료비 결제',

				amount : price,

				//buyer_email : 'nava@naver.com',
				buyer_name : 'patient',
			//buyer_tel : '010-1234-5678',
			//buyer_addr : '서울특별시',
			//buyer_postcode : '111-111'
			//m_redirect_url : 'https://www.yourdomain.com/payments/complete'

			}, function(rsp) {
				console.log(rsp);
				if (rsp.success) {
					var msg = '결제가 완료되었습니다. 감사합니다.';
					//msg += '고유ID : ' + rsp.imp_uid;
					//msg += '상점 거래ID : ' + rsp.merchant_uid;
					//msg += '결제 금액 : ' + rsp.paid_amount;
					//msg += '카드 승인번호 : ' + rsp.apply_num;
					document.location.href = "/";//아란트창 확인후 이동할 url
					$.ajax({
						type : "POST",
						url : "/",//충전 금액값을 보낼 url
						data : {
							"amount" : price,
							"userId" : 'patient',

						},

					});

				} else {
					var msg = '결제에 실패하였습니다.';
					msg += '사유 : ' + rsp.error_msg;
				}
				alert(msg);
				document.location.href = "/payment/payment";//아란트창 확인후 이동할 url

			});
		}
</script>